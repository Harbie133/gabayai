<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Symptom Analyzer - GabayAI</title>
<!-- Update paths to your actual CSS files if needed -->
<link rel="stylesheet" href="navbar.css">
<link rel="stylesheet" href="analyzerv2.css"> 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  /* --- NAVBAR FIXES --- */
  .mobile-menu-items {
    display: flex !important;
    flex-direction: column !important;
    align-items: stretch !important;
    gap: 10px !important;
  }
  .mobile-menu { z-index: 9999 !important; }

  /* --- ANALYZER STYLES --- */
  .load-more-conditions {
    margin-top: 10px; font-size: 0.9rem; color: #4f46e5; cursor: pointer;
    display: inline-flex; align-items: center; gap: 5px; font-weight: 500;
  }
  .load-more-conditions:hover { text-decoration: underline; }
  
  .ai-disclaimer-banner {
    background-color: #fff3cd; border-left: 5px solid #ffc107; padding: 15px;
    margin-bottom: 20px; border-radius: 4px; display: flex; align-items: flex-start;
    gap: 12px; font-size: 0.9rem; color: #856404;
  }
  .ai-disclaimer-banner i { font-size: 1.2rem; margin-top: 2px; }
  
  .remedy-badge {
    background: #e6fffa; color: #047481; padding: 2px 8px; border-radius: 12px;
    font-size: 0.75rem; font-weight: bold; margin-left: 8px; vertical-align: middle;
  }

  /* NEW: Triage + Drug warning support */
  #triage-container { text-align: center; margin-bottom: 10px; font-size: 0.9rem; }
  .triage-badge {
    display: inline-block; padding: 4px 10px; border-radius: 999px;
    color: #fff; font-weight: 600; margin-bottom: 4px;
  }
  #drug-warning-container {
    display: none; background-color: #f8d7da; border: 1px solid #f5c6cb;
    color: #721c24; padding: 10px 12px; border-radius: 5px; margin-bottom: 15px; font-size: 0.9rem;
  }

  /* Resume Alert */
  #resume-alert {
      display: none; background: #e0f2fe; color: #0369a1; border: 1px solid #bae6fd;
      padding: 15px; margin-bottom: 20px; border-radius: 6px; align-items: center;
      justify-content: space-between; gap: 10px;
  }
  #resume-alert button {
      background: #0ea5e9; color: white; border: none; padding: 8px 16px;
      border-radius: 4px; cursor: pointer; font-weight: bold; white-space: nowrap;
  }
  #resume-alert button:hover { background: #0284c7; }

  /* Saving Indicator */
  #save-status {
      text-align: right; font-size: 0.8rem; color: #888; margin-bottom: 5px; height: 1.2em; font-weight: bold;
  }
</style>
</head>
<body>

<!-- RESPONSIVE NAVBAR -->
<nav class="navbar">
  <div class="navbar-container">
    <a href="homer.html" class="navbar-logo">GabayAI</a>
    <ul class="navbar-nav"> 
      <li><a href="homer.html" class="nav-link ">Dashboard</a></li>
      <li><a href="analyzerv2.html" class="nav-link active">Analyzer</a></li>
      <li><a href="consult.html" class="nav-link ">Consultation</a></li>
      <li><a href="editaccount.html" class="nav-link">Profile</a></li>
      <li>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </li>
    </ul>
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
      <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
    </button>
  </div>
  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-items">
      <a href="homer.html" class="mobile-nav-link ">Dashboard</a>
      <a href="analyzerv2.html" class="mobile-nav-link active">Analyzer</a>
      <a href="consult.html" class="mobile-nav-link ">Consultation</a>
      <a href="editaccount.html" class="mobile-nav-link ">Profile</a>
      <div class="mobile-logout">
        <button onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </div>
    </div>
  </div>
</nav>  

<div class="main-content">
<div class="container" id="mainContainer">
  <h2>Symptom Analyzer</h2>

  <!-- RESUME PREVIOUS SESSION ALERT -->
  <div id="resume-alert">
      <div>
        <strong>Unfinished Analysis Found</strong><br>
        <span style="font-size:0.9em;">You have a recent analysis saved. Do you want to view it?</span>
      </div>
      <button onclick="restorePreviousAnalysis()">View Results</button>
  </div>

  <!-- Step 1: Vitals -->
  <div class="step active" id="step1">
    <div class="form-group">
      <div class="section-label">Personal Information</div>
      <div class="form-row">
        <div class="form-field">
          <label for="age">Age</label>
          <input type="number" id="age" placeholder="Age" min="1" max="130" oninput="validateAge(this)">
          <div id="age-error" class="error-message">Invalid age</div>
        </div>
        <div class="form-field">
          <label for="gender">Gender</label>
          <select id="gender">
            <option value="">Select</option>
            <option>Male</option>
            <option>Female</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="section-label">Body Measurements</div>
      <div class="form-row">
        <div class="form-field">
          <label for="height">Height (cm)</label>
          <input type="number" id="height" placeholder="cm" oninput="validatePositiveNumber(this, 'height-error')">
          <div id="height-error" class="error-message">Invalid height</div>
        </div>
        <div class="form-field">
          <label for="weight">Weight (kg)</label>
          <input type="number" id="weight" placeholder="kg" oninput="validatePositiveNumber(this, 'weight-error')">
          <div id="weight-error" class="error-message">Invalid weight</div>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="section-label">Vital Signs</div>
      <div class="form-field">
        <label for="bp">Blood Pressure</label>
        <input type="text" id="bp" placeholder="e.g. 120/80 mmHg">
      </div>
    </div>

    <div class="button-group">
      <button onclick="validateStep1()">Continue</button>
    </div>
  </div>

  <!-- Step 2: Symptoms -->
  <div class="step" id="step2">
    <label for="symptoms">Describe your symptoms</label>
    <textarea id="symptoms" placeholder="Pwede Tagalog or English. Masakit ba ulo? Kailan nagsimula?"></textarea>

    <div class="form-group followup-section" id="followup-section">
      <div class="section-label">Follow-up Questions</div>
      <div id="questions-container"></div>
      <p class="followup-hint">Select the best match or 'Hindi ko alam'.</p>
    </div>

    <div class="button-group">
      <button onclick="prevStep(2)">Back</button>
      <button id="step2-main-btn" onclick="handleStep2()">Next</button>
    </div>

    <div class="analyzing" id="analyzing">
      <div class="spinner-container"><div class="spinner"></div></div>
      <div class="analyzing-text" id="analyzing-text">Analyzing your symptoms...</div>
    </div>
  </div>

  <!-- Step 3: Results -->
  <div class="step" id="step3">
    <h3>Health Assessment Results</h3>
    <div id="save-status"></div>

    <div id="triage-container"></div>

    <div class="ai-disclaimer-banner">
      <i class="fas fa-robot"></i>
      <div>
        <strong>Paalala / Reminder:</strong>
        <p style="margin: 0;">
          This result is generated by AI and is <strong>NOT a final medical diagnosis</strong>. 
          Use this only as a guide. Always consult a licensed doctor for proper medication and treatment.
        </p>
      </div>
    </div>

    <div id="drug-warning-container"></div>

    <div id="red-flags-card" class="warning-banner collapsed">
      <div class="warning-header" onclick="toggleRedFlags()">
        <div style="display:flex;align-items:center;gap:8px;">
          <i class="fas fa-triangle-exclamation"></i>
          <span>Important Health Notices (Red Flags)</span>
        </div>
        <i class="fas fa-chevron-down chevron-icon" id="red-flag-chevron"></i>
      </div>
      <ul id="red-flags-list"></ul>
    </div>

    <div class="results-layout">
      <!-- Sidebar for List -->
      <div class="results-sidebar" id="condition-list"></div>

      <!-- Detail View -->
      <div class="results-detail">
        <div id="detail-placeholder" class="detail-placeholder">
          <i class="fas fa-hand-point-left"></i>
          <p>Select a condition to see Home Remedies & Details.</p>
        </div>

        <div id="detail-content" style="display:none;">
          <div class="detail-header">
            <h3 id="det-name" class="detail-title">Condition Name</h3>
            <span id="det-badge" class="match-badge">High Match</span>
          </div>

          <div class="detail-section">
            <h4>Overview</h4>
            <p id="det-overview"></p>
          </div>

          <div class="detail-section">
            <h4>Matching Symptoms</h4>
            <ul id="det-symptoms"></ul>
          </div>

          <div class="detail-section">
            <h4>
                <i class="fas fa-mug-hot" style="color:#e07a5f; margin-right:5px;"></i>
                Home Remedies & Self Care 
                <span class="remedy-badge">No Prescription Needed</span>
            </h4>
            <div class="treatment-box">
              <ul id="det-treatment"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="button-group">
      <button onclick="prevStep(3)">Back to answers</button>
      <button onclick="location.reload()">Start Over</button>
    </div>
  </div>
</div>
</div>

<script src="auth-guard.js"></script>
<script src="language-manager.js"></script>

<!-- INTERNAL SCRIPT (UPDATED LOGIC) -->
<script>
// ==========================================
// CORE VARIABLES & LOGIC (Merged analyzerv2.js)
// ==========================================

let followupGenerated = false;
let analysisData = null; // Holds the AI Result
let showAllConditions = false; 
let savedAnalysisData = null; // Holds Database Result

// --- 1. AUTOSAVE: CHECK ON LOAD ---
document.addEventListener('DOMContentLoaded', async () => {
    console.log('App loaded. Checking for saved analysis...');
    try {
        const response = await fetch('get_latest_analysis.php');
        const data = await response.json();
        if (data.success && data.data) {
            savedAnalysisData = data.data; 
            document.getElementById('resume-alert').style.display = 'flex';
        }
    } catch (error) {
        console.error("Failed to load history:", error);
    }
});

// --- 2. AUTOSAVE: RESTORE FUNCTION ---
function restorePreviousAnalysis() {
    if (!savedAnalysisData) return;

    // Fill inputs
    if(savedAnalysisData.input_symptoms) document.getElementById('symptoms').value = savedAnalysisData.input_symptoms;
    if(savedAnalysisData.age) document.getElementById('age').value = savedAnalysisData.age;
    if(savedAnalysisData.gender) document.getElementById('gender').value = savedAnalysisData.gender;
    if(savedAnalysisData.height_cm) document.getElementById('height').value = savedAnalysisData.height_cm;
    if(savedAnalysisData.weight_kg) document.getElementById('weight').value = savedAnalysisData.weight_kg;
    if(savedAnalysisData.blood_pressure) document.getElementById('bp').value = savedAnalysisData.blood_pressure;

    // Hide Alert
    document.getElementById('resume-alert').style.display = 'none';

    // Set Global Data
    analysisData = {
        conditions: savedAnalysisData.results,
        urgency_level: savedAnalysisData.urgency_level,
        triage_message: "Restored from history", 
        drug_interaction_warning: "N/A (Restored)",
        red_flags: [] 
    };

    // Go to Results
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.getElementById('step3').classList.add('active');

    // Render
    renderResults();
}

// --- 3. AUTOSAVE: SAVE FUNCTION ---
async function performAutoSave() {
    const statusEl = document.getElementById('save-status');
    statusEl.innerText = "Saving results...";
    
    // Check if data exists
    if (!analysisData || !analysisData.conditions) {
        statusEl.innerText = "No data to save.";
        console.warn("AutoSave Skipped: analysisData is null or empty");
        return;
    }

    const payload = {
        input_symptoms: document.getElementById('symptoms').value,
        age: document.getElementById('age').value || null,
        gender: document.getElementById('gender').value || null,
        height_cm: document.getElementById('height').value || null,
        weight_kg: document.getElementById('weight').value || null,
        blood_pressure: document.getElementById('bp').value || null,
        urgency_level: analysisData.urgency_level || 'Normal',
        results: analysisData.conditions
    };

    try {
        const res = await fetch('save_analysis.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        const json = await res.json();
        
        console.log("Save Response:", json); // Debugging

        if(json.success) {
            statusEl.innerText = "Analysis saved to history âœ”";
            statusEl.style.color = "green";
        } else {
            statusEl.innerText = "Save failed: " + (json.error || "Unknown error");
            statusEl.style.color = "red";
        }
    } catch (e) {
        console.error("Autosave error:", e);
        statusEl.innerText = "Save connection error.";
        statusEl.style.color = "red";
    }
}

// --- VALIDATION LOGIC ---
function validateAge(input) {
  const errorElement = document.getElementById('age-error');
  const value = parseInt(input.value);
  if (input.value === '') {
    input.classList.remove('invalid');
    errorElement.style.display = 'none';
    return true;
  }
  if (isNaN(value) || value < 1 || value > 130) {
    input.classList.add('invalid');
    errorElement.style.display = 'block';
    return false;
  }
  input.classList.remove('invalid');
  errorElement.style.display = 'none';
  return true;
}

function validatePositiveNumber(input, errorId) {
  const errorElement = document.getElementById(errorId);
  const value = parseFloat(input.value);
  if (input.value === '') {
    input.classList.remove('invalid');
    errorElement.style.display = 'none';
    return true;
  }
  if (isNaN(value) || value < 1) {
    input.classList.add('invalid');
    errorElement.style.display = 'block';
    return false;
  }
  input.classList.remove('invalid');
  errorElement.style.display = 'none';
  return true;
}

function validateStep1() {
  const ageValid = validateAge(document.getElementById('age'));
  const hValid = validatePositiveNumber(document.getElementById('height'), 'height-error');
  const wValid = validatePositiveNumber(document.getElementById('weight'), 'weight-error');

  if (ageValid && hValid && wValid) {
    nextStep(1);
  } else {
    document.querySelector('.invalid')?.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }
}

// --- NAVIGATION ---
function nextStep(step) {
  document.getElementById("step" + step).classList.remove("active");
  document.getElementById("step" + (step + 1)).classList.add("active");
}
function prevStep(step) {
  document.getElementById("step" + step).classList.remove("active");
  document.getElementById("step" + (step - 1)).classList.add("active");
}
function toggleRedFlags() {
  const card = document.getElementById("red-flags-card");
  const chevron = document.getElementById("red-flag-chevron");
  card.classList.toggle("collapsed");
  chevron.classList.toggle("fa-chevron-down");
  chevron.classList.toggle("fa-chevron-up");
}

// --- STEP 2: MAIN HANDLER ---
async function handleStep2() {
  const symptoms = document.getElementById("symptoms").value.trim();
  if (!symptoms) {
    alert("Please describe your symptoms first.");
    return;
  }
  if (!followupGenerated) {
    await generateFollowupQuestions();
  } else {
    await analyzeSymptoms();
  }
}

function collectBasePayload() {
  return {
    age: document.getElementById("age").value,
    gender: document.getElementById("gender").value,
    height: document.getElementById("height").value,
    weight: document.getElementById("weight").value,
    bloodPressure: document.getElementById("bp").value,
    symptoms: document.getElementById("symptoms").value.trim()
  };
}

// --- API: FOLLOW-UP ---
async function generateFollowupQuestions() {
  const analyzing = document.getElementById("analyzing");
  const txt = document.getElementById("analyzing-text");
  txt.textContent = "Thinking of follow-up questions...";
  analyzing.style.display = "flex";

  const data = collectBasePayload();
  data.step = 1;

  try {
    const res = await fetch("http://localhost:5000/analyze", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await res.json();
    analyzing.style.display = "none";

    let questionsArray = (result && Array.isArray(result.questions)) ? result.questions : [];
    if (!questionsArray.length) questionsArray = getFallbackQuestions();

    followupGenerated = true;
    renderFollowupQuestions(questionsArray);
    
    document.getElementById("step2-main-btn").textContent = "Analyze Symptoms";
    document.getElementById("followup-section").style.display = "block";
    document.getElementById("followup-section").scrollIntoView({ behavior: 'smooth', block: 'start' });

  } catch (err) {
    analyzing.style.display = "none";
    console.error("Error generating questions:", err);
    await analyzeSymptoms(); // Skip on error
  }
}

function renderFollowupQuestions(questions) {
  const container = document.getElementById("questions-container");
  container.innerHTML = "";

  questions.forEach((q, idx) => {
    const qText = q.question?.text || q.question || `Question ${idx+1}`;
    let opts = q.options || [];
    opts = opts.map(o => (typeof o === 'object' ? Object.values(o)[0] : o));

    const group = document.createElement("div");
    group.className = "form-group";
    const optionsHtml = opts.map(opt => `<option value="${opt}">${opt}</option>`).join("");
    
    group.innerHTML = `
      <label>${qText}</label>
      <select class="followup-input" data-question="${qText}">
        <option value="">Select answer...</option>
        ${optionsHtml}
      </select>
    `;
    container.appendChild(group);
  });
}

function getFallbackQuestions() {
  return [
    { question: "Gaano katagal na?", options: ["Ngayon lang", "2-7 araw", "Mahigit 1 linggo", "Hindi ko alam"] },
    { question: "Gaano kalala (1-10)?", options: ["Mild (1-3)", "Moderate (4-6)", "Severe (7-10)", "Hindi ko alam"] },
    { question: "Ano nagpapalala?", options: ["Pagkain/Inumin", "Paggalaw", "Wala", "Hindi ko alam"] }
  ];
}

// --- API: FINAL ANALYSIS ---
async function analyzeSymptoms() {
  const analyzing = document.getElementById("analyzing");
  const txt = document.getElementById("analyzing-text");
  txt.textContent = "Analyzing symptoms (Top 5 Matches)...";
  analyzing.style.display = "flex";

  const inputs = document.querySelectorAll(".followup-input");
  const answers = Array.from(inputs).map(inp => ({
    question: inp.getAttribute("data-question"),
    answer: inp.value.trim()
  })).filter(a => a.answer);

  const data = collectBasePayload();
  data.step = 2;
  data.answers = answers;

  try {
    const res = await fetch("http://localhost:5000/analyze", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    if (!res.ok) throw new Error("Server error");
    
    // IMPORTANT: removed 'const' so global 'analysisData' is updated
    analysisData = await res.json();
    
    analyzing.style.display = "none";

    nextStep(2); // Go to Step 3
    showAllConditions = false;
    renderResults();

    // TRIGGER AUTO SAVE
    console.log("Triggering Auto Save...");
    performAutoSave(); 

    // Optional Tracking
    trackSymptomAnalyzerUsage(data.symptoms, analysisData);

  } catch (err) {
    analyzing.style.display = "none";
    console.error("Analysis error:", err);
    alert("Sorry, nagka-error sa server. Try again later.");
  }
}

// --- RENDER RESULTS ---
function renderResults() {
  const redCard = document.getElementById("red-flags-card");
  const list = document.getElementById("red-flags-list");
  
  // Triage
  const triageDiv = document.getElementById("triage-container");
  if (triageDiv && analysisData) {
    const level = analysisData.urgency_level || "Self Care";
    let color = "#22c55e";
    if (level.includes("Urgent")) color = "#facc15";
    if (level.includes("Emergency")) color = "#ef4444";
    triageDiv.innerHTML = `
      <span class="triage-badge" style="background:${color};">${level}</span>
      <div>${analysisData.triage_message || ""}</div>
    `;
  }

  // Drug Warning
  const drugDiv = document.getElementById("drug-warning-container");
  if (drugDiv && analysisData && analysisData.drug_interaction_warning && analysisData.drug_interaction_warning !== "None") {
    drugDiv.textContent = `ðŸ’Š Drug Interaction Warning: ${analysisData.drug_interaction_warning}`;
    drugDiv.style.display = "block";
  } else if (drugDiv) {
    drugDiv.style.display = "none";
  }
  
  // Red Flags
  if (analysisData.red_flags && analysisData.red_flags.length > 0) {
    list.innerHTML = analysisData.red_flags.map(f => `<li>${f}</li>`).join("");
    redCard.style.display = "block";
  } else {
    redCard.style.display = "none";
  }

  // Conditions List
  const listDiv = document.getElementById("condition-list");
  listDiv.innerHTML = "";

  if (!analysisData.conditions || !analysisData.conditions.length) {
    listDiv.innerHTML = "<p>No specific conditions found.</p>";
    return;
  }

  const allConds = analysisData.conditions;
  const DEFAULT_VISIBLE = 5; 
  const visibleCount = showAllConditions ? allConds.length : Math.min(DEFAULT_VISIBLE, allConds.length);

  allConds.slice(0, visibleCount).forEach((cond, idx) => {
    const level = cond.match_level || "Possible";
    const color = cond.match_color || "#48bb78";
    let width = "50%";
    if (level === "High") width = "90%";
    if (level === "Low") width = "30%";

    const card = document.createElement("div");
    card.className = "condition-card" + (idx === 0 ? " selected" : "");
    card.innerHTML = `
      <div class="cond-name">${cond.name}</div>
      <div class="match-bar-bg">
        <div class="match-bar-fill" style="width:${width};background:${color};"></div>
      </div>
      <div class="cond-match-label">${level} Match</div>
    `;
    card.addEventListener("click", () => showConditionDetail(idx));
    listDiv.appendChild(card);
  });

  // Load More Button
  if (allConds.length > DEFAULT_VISIBLE) {
    const more = document.createElement("div");
    more.className = "load-more-conditions";
    more.innerHTML = showAllConditions
      ? `<i class="fas fa-chevron-up"></i> Show Top ${DEFAULT_VISIBLE} Only`
      : `<i class="fas fa-chevron-down"></i> Show All ${allConds.length} Results`;
    
    more.addEventListener("click", () => {
      showAllConditions = !showAllConditions;
      renderResults(); 
    });
    listDiv.appendChild(more);
  }

  showConditionDetail(0);
}

function showConditionDetail(index) {
  if (!analysisData || !analysisData.conditions[index]) return;
  const cond = analysisData.conditions[index];

  document.querySelectorAll(".condition-card").forEach((c, i) => {
    c.classList.toggle("selected", i === index);
  });

  document.getElementById("detail-placeholder").style.display = "none";
  document.getElementById("detail-content").style.display = "block";

  document.getElementById("det-name").textContent = cond.name;
  
  const badge = document.getElementById("det-badge");
  badge.textContent = `${cond.match_level} Match`;
  badge.style.backgroundColor = cond.match_color;

  document.getElementById("det-overview").textContent = cond.overview;

  const symList = cond.symptoms_matched || [];
  document.getElementById("det-symptoms").innerHTML = symList.length
    ? symList.map(s => `<li>${s}</li>`).join("")
    : "<li>No matches listed</li>";

  const treatList = cond.treatment || [];
  document.getElementById("det-treatment").innerHTML = treatList.length
    ? treatList.map(t => `<li>${t}</li>`).join("")
    : "<li>See doctor for advice.</li>";
}

function trackSymptomAnalyzerUsage(symptoms, diagnosis) {
  fetch('track_symptom_usage.php', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      symptoms, diagnosis, timestamp: new Date().toISOString()
    })
  }).catch(e => console.warn("Track usage failed"));
}

function logout() {
  if (confirm('Are you sure you want to logout?')) {
      window.location.href = 'user_logout.php';
  }
}

function toggleMobileMenu() {
  document.getElementById('mobileMenu').classList.toggle('show');
  document.getElementById('hamburger').classList.toggle('open');
}

// Close Mobile Menu Outside Click
document.addEventListener('click', function(e) {
  const mm = document.getElementById('mobileMenu');
  const ham = document.getElementById('hamburger');
  const btn = document.querySelector('.mobile-menu-btn');
  if (btn && !btn.contains(e.target) && !mm.contains(e.target)) {
    mm.classList.remove('show');
    ham.classList.remove('open');
  }
});
</script>
</body>
</html>
